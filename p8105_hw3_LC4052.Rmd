---
title: "p8105_hw3_LC4052"
output: github_document
Author: "Linqi Chu"
date: "2025-10-06"
---

```{r}
library(tidyverse)
library(ggridges)
library(patchwork)
library(dplyr)

```


# Problem 1

## Import data

```{r}
library(p8105.datasets)
data("instacart")
```

## Description of variables

The dataset includes`r nrow(instacart)` observations and `r ncol(instacart)` variables, including `r names(instacart)`.

There are `r n_distinct(instacart$product_id)` distinct product ids and `r n_distinct(instacart$product_name)` product names. Departments contain `r unique(instacart$department)`.

## Number of aisles

```{r}
instacart |>
  count(aisle) |>
  arrange(desc(n)) |>
  slice(1) |>
  pull(aisle)

```
There are `r n_distinct(instacart$aisle` aisles. "fresh vegetables" are the most items ordered from.

## Plot of the number of items ordered in each aisle

```{r}
instacart |>
  count(aisle) |>
  filter(n > 10000) |>
  ggplot(aes(x = reorder(aisle, n), y = n)) +
  geom_col(fill = "steelblue", alpha = 0.8) +
  coord_flip() +
  labs(
    title = "Number of Items Ordered in Each Aisle",
    subtitle = "Aisles with more than 10,000 items ordered",
    x = "Aisle",
    y = "Number of Items Ordered"
  ) +
  theme_minimal() +
  scale_y_continuous(labels = scales::comma)

```

## Table of the three most popular items

```{r}
instacart |>
  filter(aisle %in% c("baking ingredients", "dog food care", "packaged vegetables fruits")) |>
  group_by(aisle, product_name) |>
  summarise(order_count = n()) |>
  group_by(aisle) |>
  slice_max(order_count, n = 3) |>
  arrange(aisle, desc(order_count))
 
```

## Table of the mean hour

```{r}
instacart |>
  filter(product_name %in% c("Pink Lady Apples", "Coffee Ice Cream")) |>
  mutate(
    day_of_week = wday(order_hour_of_day, label = TRUE, abbr = FALSE, week_start = 1),
    hour_of_day = order_hour_of_day
  ) |>
  group_by(product_name, day_of_week) |>
  summarize(mean_hour = round(mean(hour_of_day), 1)) |>
  pivot_wider(
    names_from = day_of_week,
    values_from = mean_hour
  )

```


## Problem 2




```{r}
pulse_data = 
  haven::read_sas("./data/public_pulse_data.sas7bdat") |>
  janitor::clean_names() |>
  pivot_longer(
    bdi_score_bl:bdi_score_12m,
    names_to = "visit", 
    names_prefix = "bdi_score_",
    values_to = "bdi") |>
  select(id, visit, everything()) |>
  mutate(
    visit = replace(visit, visit == "bl", "00m"),
    visit = factor(visit, levels = str_c(c("00", "01", "06", "12"), "m"))) |>
  arrange(id, visit)

pulse_data |> 
  group_by(visit) |> 
  summarize(
    mean_bdi = mean(bdi, na.rm = TRUE),
    median_bdi = median(bdi, na.rm = TRUE)) |> 
  knitr::kable(digits = 3)
```



```{r}

```


```{r}

```

